
#
# This C-shell script simulates the ANSI C Preprocessor by using sed to do
# token pasting. Usage syntax is:
#
#	pp input_file [cc-flags]
#
# The extra space in the first sed invocation is required because cpp
# occasionally adds a space after the input token (but not always).
# The third sed invokation takes care of a bug in cpp, which doesn't generate
# proper #line directives. The output file from this script can be submitted
# to cc without difficulty.
#
set fname=$1:t
echo making $fname:r.pp.c
cc -E $2 $1 | sed 's/## //g' | sed 's/##//g' \
	    | sed 's/^# \([0-9]\)/#line \1/' > $fname:r.pp.c
